version: '3.8'
services:
  # AWS CLI for basic operations
  aws-cli:
    image: cleanstart/aws-cli:latest
    container_name: aws-cli-basic
    restart: unless-stopped
    volumes:
      - ~/.aws:/aws/config:ro
      - ./data:/aws/data
      - ./scripts:/aws/scripts
    environment:
      - AWS_CONFIG_FILE=/aws/config/config
      - AWS_SHARED_CREDENTIALS_FILE=/aws/config/credentials
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION:-us-east-1}
    command: ["help"]
    networks:
      - aws-network

  # AWS CLI helper for interactive sessions
  aws-helper:
    image: cleanstart/aws-cli:latest
    container_name: aws-cli-helper
    restart: unless-stopped
    volumes:
      - ~/.aws:/aws/config:ro
      - ./data:/aws/data
      - ./scripts:/aws/scripts
    environment:
      - AWS_CONFIG_FILE=/aws/config/config
      - AWS_SHARED_CREDENTIALS_FILE=/aws/config/credentials
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION:-us-east-1}
    profiles:
      - interactive
    stdin_open: true
    tty: true
    networks:
      - aws-network

volumes:
  aws_data:
    driver: local

networks:
  aws-network:
    driver: bridge